package com.hck.zhuanqian.ui;import android.os.Bundle;import android.os.Handler;import android.os.Message;import android.view.View;import android.widget.TextView;import cn.aow.android.DAOW;import cn.aow.android.DListener;import com.hck.kedouzq.R;import com.hck.zhuanqian.data.Contans;import com.hck.zhuanqian.util.LogUtil;import com.hck.zhuanqian.view.MyToast;/** *  * @author *  */public class DuoMengActivity extends BaseActivity {    private int point;    private int size;    @Override    protected void onCreate(Bundle savedInstanceState) {        super.onCreate(savedInstanceState);        initAd();        setContentView(R.layout.activity_duomeng);        initTitle("小盟专区");        getAdInitData();        initDownSize(findViewById(R.id.down_size));    }    private void initAd() {        try {            DAOW.getInstance(this).init(this, Contans.DUOMENG_KEY);        } catch (Exception e) {            MyToast.showCustomerToast("初始化数据失败 请重试 ");            finish();        }    }    public void startGetMoney(View view) {        try {            DAOW.getInstance(this).show(this);        } catch (Exception e) {            MyToast.showCustomerToast("初始化数据失败 请重试 ");        }    }    @Override    protected void onResume() {        super.onResume();        try {            DAOW.getInstance(this).checkPoints(new DListener() {                @Override                public void onResponse(Object... arg0) {                    try {                        if (arg0 != null) {                            Integer all = (Integer) arg0[1];                            Integer xiaofei = (Integer) arg0[0];                            int jinb = all - xiaofei;                            point = jinb;                            if (point > 0) {                                Message message = new Message();                                message.what = HUAFEI;                                message.arg1=(int) point;                                handler.sendMessage(message);                            }                        }                    } catch (Exception e) {                        LogUtil.D("dd:onResume Exception" + e.toString());                    }                }                @Override                public void onError(String arg0) {                    LogUtil.D("dd:onResume onError" + arg0.toString());                }            });        } catch (Exception e) {            LogUtil.D("dd:onResume onError222" + e.toString());        }    }    Handler handler = new Handler() {        public void handleMessage(android.os.Message msg) {                        point = 0;            point = msg.what;            if (point > 600) {                point = 150;            }            if (msg.what==HUAFEI) {                huafei(point);            }            else if (msg.what==HUAFEI_SUCCESS) {                savePoint(Contans.AD_NAME_DUOMENG, point);            }           else if (msg.what==HUAFEI_FAIL) {               MyToast.showCustomerToast("网络异常，增加金币失败，下次一起补上金币");        }        };    };    private void huafei(final int point) {        try {            DAOW.getInstance(this).consumePoints(point, new DListener() {                @Override                public void onResponse(Object... arg0) {                    Message message =new Message();                    message.what=HUAFEI_SUCCESS;                    message.arg1=point;                    handler.sendMessage(message);                }                @Override                public void onError(String arg0) {                    if (size < 4) {                        huafei(point);                        size++;                    }                    else {                        Message message =new Message();                        message.what=HUAFEI_FAIL;                        handler.sendMessage(message);                    }                }            });        } catch (Exception e) {        }    }}