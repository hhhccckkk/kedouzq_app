package com.hck.zhuanqian.ui;import android.os.Bundle;import android.text.TextUtils;import android.view.View;import android.widget.EditText;import com.hck.httpserver.JsonHttpResponseHandler;import com.hck.httpserver.RequestParams;import com.hck.zhuanqian.R;import com.hck.zhuanqian.bean.UserBean;import com.hck.zhuanqian.data.MyData;import com.hck.zhuanqian.net.Request;import com.hck.zhuanqian.util.LogUtil;import com.hck.zhuanqian.view.MyToast;import com.hck.zhuanqian.view.Pdialog;public class UpdateUserInfoActivity extends BaseActivity {	private EditText nichenEditText, phonEditText, qqEditText,			zhifubaoEditText;	private String userName, userPhone, userQQ, userZhiFuBao;	@Override	protected void onCreate(Bundle savedInstanceState) {		super.onCreate(savedInstanceState);		setContentView(R.layout.activity_update_user_info);		initTitle("修改用户信息");		initView();	}	private void initView() {		UserBean userBean = MyData.getMyData().getUserBean();		nichenEditText = (EditText) findViewById(R.id.user_nicheng);		phonEditText = (EditText) findViewById(R.id.user_phone);		qqEditText = (EditText) findViewById(R.id.user_qq);		zhifubaoEditText = (EditText) findViewById(R.id.user_zhifubao);		if (!TextUtils.isEmpty(userBean.getName())) {			nichenEditText.setText(userBean.getName());		}		if (!TextUtils.isEmpty(userBean.getPhone())) {			phonEditText.setText(userBean.getPhone());		}		if (!TextUtils.isEmpty(userBean.getQq())) {			qqEditText.setText(userBean.getQq());		}		if (!TextUtils.isEmpty(userBean.getZhifubao())) {			zhifubaoEditText.setText(userBean.getZhifubao());		}	}	public void updateUser(View view) {		getData();		if (checkData()) {			Pdialog.showDialog(this, "正在修改用户", true);			updateUserInfo();		}	}	private void updateUser() {		MyData.getData().getUserBean().setQq(userQQ);		MyData.getData().getUserBean().setZhifubao(userZhiFuBao);		MyData.getData().getUserBean().setName(userName);		MyData.getData().getUserBean().setPhone(userPhone);	}	private void getData() {		userName = nichenEditText.getText().toString();		userPhone = phonEditText.getText().toString();		userQQ = qqEditText.getText().toString();		userZhiFuBao = zhifubaoEditText.getText().toString();	}	private boolean checkData() {		if (TextUtils.isEmpty(userName)) {			MyToast.showCustomerToast("昵称不能为空");			return false;		} else if (TextUtils.isEmpty(userPhone)) {			MyToast.showCustomerToast("电话号码不能为空");			return false;		} else if (TextUtils.isEmpty(userQQ)) {			MyToast.showCustomerToast("QQ不能为空");			return false;		} else if (TextUtils.isEmpty(userZhiFuBao)) {			MyToast.showCustomerToast("支付宝账号不能为空");			return false;		} else if (userName.length() < 2) {			MyToast.showCustomerToast("昵称不能少于2个");			return false;		} else if (userName.length() > 12) {			MyToast.showCustomerToast("昵称不能大于12个");			return false;		} else {			return true;		}	}	private void updateUserInfo() {		params = new RequestParams();		params.put("uid", MyData.getData().getUserBean().getId() + "");		params.put("nicheng", userName);		params.put("phone", userPhone);		params.put("qq", userQQ);		params.put("zhifubao", userZhiFuBao);		Request.updateUserInfo(params, new JsonHttpResponseHandler() {			public void onFinish(String url) {				Pdialog.hiddenDialog();			};			public void onSuccess(int statusCode, org.json.JSONObject response) {				LogUtil.D("onSuccess: " + response.toString());				try {					isOK = response.getBoolean("isok");					if (isOK) {						MyToast.showCustomerToast("修改成功");						updateUser();						finish();					} else {						MyToast.showCustomerToast("修改失败");					}				} catch (Exception e) {					MyToast.showCustomerToast("修改失败");				}			};			public void onFailure(Throwable error, String content) {				LogUtil.D("onFailure: " + content);				MyToast.showCustomerToast("修改失败 请检查您的网络");			};		});	}}